{"version":3,"sources":["ng://@opten/rxjs/lib/storage/observable-storage.ts"],"names":["ObservableStorage","_key","_storageProvider","this","_subject","BehaviorSubject","parse","prototype","change","asObservable","pipe","share","get","observableOf","set","data","setItem","JSON","stringify","next","clear","removeItem","item","getItem"],"mappings":"+TAKA,iBAGC,SAAAA,EAAoBC,EAAsBC,GAAtBC,KAAAF,KAAAA,EAAsBE,KAAAD,iBAAAA,EAFlCC,KAAAC,SAA2B,IAAIC,EAAAA,gBAAuBF,KAAKG,SA+BpE,OA3BCN,EAAAO,UAAAC,OAAA,WACC,OAAOL,KAAKC,SAASK,eAAeC,KAAKC,EAAAA,UAG1CX,EAAAO,UAAAK,IAAA,WACC,OAAOC,EAAAA,GAAaV,KAAKG,UAG1BN,EAAAO,UAAAO,IAAA,SAAIC,GACHZ,KAAKD,iBAAiBc,QAAQb,KAAKF,KAAMgB,KAAKC,UAAUH,IACxDZ,KAAKC,SAASe,KAAKhB,KAAKG,UAGzBN,EAAAO,UAAAa,MAAA,WACCjB,KAAKD,iBAAiBmB,WAAWlB,KAAKF,MACtCE,KAAKC,SAASe,KAAKhB,KAAKG,UAGfN,EAAAO,UAAAD,MAAV,eACOgB,EAAenB,KAAKD,iBAAiBqB,QAAQpB,KAAKF,MAExD,OAAKqB,GAAgB,MAARA,EAINL,KAAKX,MAAMgB,GAHV,MAKVtB","sourcesContent":["import { Subject, BehaviorSubject, Observable, of as observableOf } from 'rxjs';\r\nimport { share } from 'rxjs/operators';\r\n\r\nimport { Storage as Store } from './storage';\r\n\r\nexport abstract class ObservableStorage<TData> implements Store<TData> {\r\n\tprivate _subject: Subject<TData> = new BehaviorSubject<TData>(this.parse());\r\n\r\n\tconstructor(private _key: string, private _storageProvider: Storage) {}\r\n\r\n\tchange(): Observable<TData> {\r\n\t\treturn this._subject.asObservable().pipe(share());\r\n\t}\r\n\r\n\tget(): Observable<TData> {\r\n\t\treturn observableOf(this.parse());\r\n\t}\r\n\r\n\tset(data: TData): void {\r\n\t\tthis._storageProvider.setItem(this._key, JSON.stringify(data));\r\n\t\tthis._subject.next(this.parse());\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis._storageProvider.removeItem(this._key);\r\n\t\tthis._subject.next(this.parse());\r\n\t}\r\n\r\n\tprotected parse(): TData {\r\n\t\tconst item: string = this._storageProvider.getItem(this._key);\r\n\r\n\t\tif (!item || item == null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn JSON.parse(item);\r\n\t}\r\n}\r\n"]}